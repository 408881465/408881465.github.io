<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Load the latest version of TensorFlow.js -->
    <script src="js/tfjs.js"></script>
    <script src="js/mobilenet.js"></script>


    <title>Mobilenet</title>
</head>
<body>
<div id="console"></div>
<!-- Add an image that we will use to test -->
<!--<img id="img" crossorigin src="https://i.imgur.com/JlUvsxa.jpg" width="227" height="227"/>-->
<video autoplay playsinline muted id="webcam" width="448" height="448"></video>
<div id="info"></div>
<script>
    let net;
    const webcamElement = document.getElementById('webcam');

    async function app() {
        console.log('Loading mobilenet..');
        document.getElementById('info').innerText = 'modle is loading';
        // Load the model.
        net = await mobilenet.load({
            version: 1,
            modelUrl: "model/model.json"
        });
        console.log('Successfully loaded model');
        document.getElementById('info').innerText = 'modle is loaded'

        // Create an object from Tensorflow.js data API which could capture image
        // from the web camera as Tensor.
        const webcam = await tf.data.webcam(webcamElement);
        while (true) {
            const img = await webcam.capture();
            const result = await net.classify(img,1 );
            document.getElementById('console').innerText = ` prediction: ${result[0].className}\n probability: ${result[0].probability} `;
            // Dispose the tensor to release the memory.
            img.dispose();
            // Give some breathing room by waiting for the next animation frame to
            // fire.
            await tf.nextFrame();
        }
    }

    app();
</script>
</body>
</html>